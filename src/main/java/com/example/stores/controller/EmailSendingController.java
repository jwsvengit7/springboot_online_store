package com.example.stores.controller;import com.example.stores.DTO.UserDTO;import com.example.stores.Service.UsersServicesImplentation;import jakarta.servlet.http.HttpSession;import lombok.RequiredArgsConstructor;import lombok.extern.slf4j.Slf4j;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestParam;import java.util.Objects;import static java.lang.Long.parseLong;@Controller@RequiredArgsConstructor@Slf4jpublic class EmailSendingController {    private final UsersServicesImplentation usersServicesImplentation;    @GetMapping("/otp")    public String getOtpPage(HttpSession session){        if(session.getAttribute("otp")==null){            return "redirect:/";        }else{            return "otp";        }    }    @PostMapping("/otp/create")    public String confirmUser(@RequestParam("otp") String otp, HttpSession session){        Long idOtp = (Long) session.getAttribute("otp");        Long otp_verify = parseLong(otp);        log.info("OTP{}",idOtp);        if(Objects.equals(idOtp, otp_verify)){            UserDTO userDTO = (UserDTO)session.getAttribute("userDto");            log.info("userdetails{}",userDTO);            usersServicesImplentation.validateUser(userDTO);            session.setAttribute("otp",null);            return "redirect:/";        }else{            return "otp";        }    }}